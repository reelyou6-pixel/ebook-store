<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØªØ§Ø¨</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .details {
      max-width: 400px;
      margin: 200px auto;
      background: #fff;
      padding: 80px;
      border-radius: 60px;
      box-shadow: 0 12px 18px rgba(0,0,0,0.1);
    }
    .details img {
      width:70%;
      max-height: 250px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 40px;
    }
    .details h2 {
      margin-bottom: 15px;
      color: #3b2f25;
    }
    .details p {
      margin-bottom: 15px;
      line-height: 1.7;
    }
    .details .price {
      font-weight: bold;
      color: #9b7d60;
    }
  </style>
</head>
<body>

<header>
  <h1> ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØªØ§Ø¨</h1>
  <div class="actions">
    <a href="index.html"> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="library.html">Ø§Ù„Ù…ÙØ¶Ù„Ø©</a>
  </div>
</header>

<main>
  <div class="details" id="bookDetails"></div>
</main>

<script>
  const container = document.getElementById('bookDetails');
  const book = JSON.parse(localStorage.getItem('currentBook'));

  if (book) {
    // Ù„Ùˆ Ø§Ù„ÙƒØªØ§Ø¨ Ù…ÙˆØ¬ÙˆØ¯
    container.innerHTML = `
      <img src="${book.img}" alt="${book.title}">
      <h2>${book.title}</h2>
      <p>${book.desc}</p>
      <div class="btns">
      <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${book.price.toFixed(2)} $</p>
        <button id="sampleBtn"class="primary">ØªØ­Ù…ÙŠÙ„ Ø¹ÙŠÙ†Ø© ğŸ“–</button>
        <button id="buyBtn" class="primary">Ø¶Ø¹ ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©</button>
      </div>

    `;

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹ÙŠÙ†Ø©
    document.getElementById('sampleBtn')?.addEventListener('click', () => {
      const blob = new Blob([book.sample], {type:'text/plain;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = book.title + '_sample.txt';
      a.click();
      URL.revokeObjectURL(url);
    });

    // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙƒØªØ¨Ø©
    document.getElementById('buyBtn')?.addEventListener('click', () => {
      const lib = JSON.parse(localStorage.getItem('myLibrary') || '[]');
      if (!lib.find(x => x.id === book.id)) {
        lib.push(book);
        localStorage.setItem('myLibrary', JSON.stringify(lib));
        alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØªØ§Ø¨ Ø¥Ù„Ù‰ Ù…ÙƒØªØ¨ØªÙƒ');
      } else {
        alert('ğŸ“š Ù‡Ø°Ø§ Ø§Ù„ÙƒØªØ§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù…ÙƒØªØ¨ØªÙƒ');
      }
    });

  } else {
    // Ù„Ùˆ Ù…Ø§ ÙÙŠÙ‡ ÙƒØªØ§Ø¨
    container.innerHTML = '<p>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙƒØªØ§Ø¨</p>';
  }
</script>
<footer>
   <p>Â© 2025 Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© | <a href="terms.html">Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠØ§Øª</a></p>

  </footer>
</body>
</html>
